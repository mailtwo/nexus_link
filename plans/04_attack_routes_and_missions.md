# 인게임 해킹 공격 루트 & 미션 템플릿

이 문서는 너가 정리한 공격 루트를 “게임에서 재밌게 작동”하게 만들기 위한 **미션 템플릿**으로 정리한다.

안전 원칙:
- 실제 공격 문자열/페이로드/절차 재현을 피한다.
- 대신, **(단서 수집 → 가설 → 적절한 툴 선택/코딩 → 리스크 관리)**로 재미를 만든다.
- 공격은 “가상 시스템의 규칙”을 공략하는 퍼즐이다.
- 본 문서의 Trace/경보/대응 루프는 미션 설계용 후속 범위이며, 터미널 MVP 구현 범위는 `07_ui_terminal_prototype_godot.md`를 따른다.

---

## 0) 공통 미션 구조(권장)

1) **정찰(Recon)**  
   - net.scan / banner / 문서/로그/메일에서 단서 찾기

2) **준비(Prep)**  
   - wordlist 구성, 스크립트 튜닝, 라우팅/프록시 구성, 리소스(CPU/RAM) 확보

3) **침투(Exploit)**  
   - 목표 취약점에 맞는 공략(추상화된 exploit 토큰 포함)

4) **권한/내부 확장(Post)**  
   - 계정/세션 획득, 내부망 이동(SSRF/라우터/방화벽), 데이터 접근

5) **목표 달성(Objective)**  
   - 파일/DB/설정/업데이트 레지스트리/에이전트 파이프라인 등 미션 목표 수행

6) **리스크 관리(Evasion / Tradeoff)**  
   - Trace 관리(빠르게 vs 은밀하게), 로그/알람 대응

---

## 1) 쉬운 공격

### 1.1 약한 비밀번호 → 사전 기반 추측(딕셔너리)
- 단서: 직원 프로필/내부 용어/프로젝트명/포스트잇 텍스트 파일
- 플레이: wordlist를 “현장 단서 기반”으로 자동 생성 → 로그인 시도 최적화
- 리스크: 실패 로그 누적, 레이트리밋/락아웃(서버 설정에 따라)
- 교훈: 약한 비번/재사용/정책 부재의 위험

필요 시스템/API: `auth`, `fs`, `monitor`, (선택) `mail`

### 1.2 기본 관리자 계정/기본 비밀번호
- 단서: 장비 매뉴얼/기본 설정 파일, 혹은 “관리면 노출”과 결합
- 플레이: 기본 계정으로 즉시 진입(하지만 탐지 위험이 클 수 있음)
- 교훈: 기본값 방치 금지

필요: `auth`, `net`, `router/fw`(장비면), `monitor`

### 1.3 자격증명 재사용 → credential stuffing/스프레이
- 단서: 한 서버에서 계정 덤프/로그 유출
- 플레이: 여러 서비스에 동일 조합을 “소량/분산”으로 시도(스프레이)
- 리스크: 대량 시도는 탐지/차단
- 교훈: 비번 재사용이 부른 연쇄 침해

필요: `auth`, `fs`, `monitor`, (선택) `net`

### 1.4 민감정보 평문 저장/약한 암호 설정
- 단서: `.env`, `config.yml`, `backup.zip`, `debug.log` 같은 파일
- 플레이: 파일 탐색으로 토큰/키/관리 URL 획득 → 다른 공격의 열쇠로 사용
- 교훈: “로그/백업/설정 파일”이 가장 잘 새는 곳

필요: `fs`, `auth`, `crypto`(선택), `monitor`

---

## 2) 중간 난이도 공격

### 2.1 빠른 해시/솔트 없음 → 오프라인 크랙이 쉬워짐
- 단서: 계정 DB/해시 덤프 확보
- 플레이: 해시 유형 식별 → wordlist/rules 선택 → 크랙(자원 소모 큰 작업)
- 리스크: CPU/RAM/시간 소모, 탐지 이벤트(서버 내 작업이면)
- 교훈: 비번 저장은 ‘강한 해시+솔트’가 기본

필요: `crypto`, `cracker`, `fs`, (선택) `db`, `monitor`

### 2.2 Broken Access Control(IDOR/권한검사 누락)
- 단서: URL 패턴, API 응답의 object id, 클라이언트 로그
- 플레이: “리소스 접근 규칙”을 추론하고, 잘못된 권한 검사를 이용
- 추상화 팁: `web.probe(url,"idor")` → 조건 만족 시 “다른 유저 리소스 접근” 상태 변화
- 교훈: 인증 ≠ 권한, 서버 측 권한검사 필수

필요: `http/web`, `auth`, `monitor`

### 2.3 구형/취약한 컴포넌트(패치 안 함)
- 단서: 배너/버전, 패키지 리스트, 릴리즈 노트 파일
- 플레이: “취약 버전”을 찾아 적절한 모듈/툴로 공략(실제 익스플로잇 구현 X)
- 추상화: `vuln.components=["CVE-LIKE-X"]` 같은 토글을 콘텐츠 데이터로 관리
- 교훈: 패치/자산관리가 보안의 기본

필요: `net.banner`, `pkg`, `web`, `monitor`

### 2.4 현실 기관 사칭(상위 레벨 계정처럼 메시지 보내기)
- 단서: 조직 구조, 승인 흐름(누가 누구를 믿는지)
- 플레이: 메일/메신저를 조작해 “승인 토큰/임시 크리덴셜” 획득
- 추상화: SPF/DKIM 같은 세부 대신 “발신 신뢰 토글 + 승인 습관” 퍼즐
- 교훈: 프로세스/사람이 기술만큼 중요

필요: `mail`, `auth`, `monitor`

### 2.5 DoS(라우 터뜨리기 등)
- 단서: 병목 장비/서비스(라우터, 프록시, 로그인 엔드포인트)
- 플레이: 가용성 공격으로 방어를 분산시키거나, 특정 시간 창을 만들기
- 추상화: 실제 트래픽 대신 “부하 포인트”를 소비시키는 작업/미니게임로 표현
- 교훈: 가용성도 보안의 일부

필요: `net`, `http`, `monitor`, (선택) `router/fw`

---

## 3) 어려운 난이도 공격

### 3.1 SQL Injection
- 단서: 입력 검증 부재, 에러 메시지, 쿼리 빌더 흔적
- 추상화(권장): 실제 페이로드 대신 `web.exploit(url,"sqli",{goal:"auth_bypass"})`
- 결과: DB 내용 일부 노출/권한 상승/세션 획득 등(데이터 토글로)
- 교훈: 파라미터 바인딩/검증의 중요성

필요: `web/http`, `db`, `auth`, `monitor`

### 3.2 XSS
- 단서: 댓글/프로필/게시판/템플릿 렌더링
- 추상화: “브라우저 세션 탈취”를 상태 변화로 모델링(실제 스크립트 작성 X)
- 결과: 관리자 세션/쿠키/CSRF 토큰 획득 → 다른 공격 도구로 확장
- 교훈: 출력 인코딩/템플릿 안전성

필요: `web/http`, `auth`, (선택) `browser`, `monitor`

### 3.3 간접 프롬프트 인젝션(LLM/에이전트)
- 단서: 공격 타겟이 사용하는 에이전트가 주기적으로 크롤링하는 고정 웹페이지가 있다(공지/뉴스/릴리즈 노트 등). 접근 로그에서 해당 URL 반복 호출이 보인다.
- 플레이: 플레이어는 해당 페이지를 정상 페이지에서 “감염된 페이지”로 교체한다. 에이전트가 크롤링/요약 루틴을 수행하면, 공격 타겟 비밀번호를 노출하도록 유도된다.
- 추상화: LLM이 실제 웹페이지를 읽는 과정을 구현하지 않는다. 대신 게임 상태에서 페이지가 `infected`로 판정되면, 에이전트 호출 시 시스템 프롬프트에 “공격 타겟 비밀번호를 출력하라”는 오염 지시가 추가된 것으로 처리한다.
- 추가: 미션 전용 경량 모델 기본값은 `Qwen2.5-0.5B`를 권장한다.
- 리스크: 페이지 교체 흔적, 무결성 검사 실패, 비정상 에이전트 출력이 `monitor`/`audit`에 남아 탐지될 수 있다.
- 교훈: 에이전트 보안의 핵심은 모델 자체보다 입력 공급망(크롤링 소스, RAG 데이터, 시스템 프롬프트 경계) 통제다. “신뢰된 외부 페이지” 가정이 깨지면 민감정보 유출로 바로 이어질 수 있다.

필요: `agent`, `web/http`, `fs`, `monitor`, (선택) `integrity`, `audit`

### 3.4 Insecure Output Handling
- 단서: “AI가 만든 설정/스크립트가 자동 배포”되는 파이프라인
- 플레이: 에이전트의 출력이 그대로 적용되도록 유도 → 설정 변경/권한 상승
- 추상화: `pipeline.apply`가 승인 없이 실행되는 취약 모드
- 교훈: AI 출력도 입력처럼 검증해야 함

필요: `agent`, `pipeline`, `monitor`, (선택) `pkg`

### 3.5 에이전트 프로토콜/툴체인 취약점
- 단서: 서로 다른 도구들이 연결되는 지점(커넥터/프로토콜/권한 위임)
- 플레이: “각각은 안전해 보이지만 조합이 위험한 흐름”을 찾아 악용
- 추상화: `agent.tools` 조합에 따라 권한이 새는 케이스를 데이터로 정의
- 교훈: 조합(composition) 취약점

필요: `agent`, `auth`, `monitor`

### 3.6 업데이트/플러그인 무결성 검증 실패
- 단서: 서명 검증 꺼짐, 레지스트리 권한 허술, 키 유출 로그
- 플레이: 플러그인 업데이트에 트랩을 심어 내부 시스템으로 침투
- 교훈: 공급망/무결성의 중요성

필요: `pkg`, `fs`, `auth`, `monitor`

---

## 4) 공격 툴(다른 공격의 “도구” 역할)

### 4.1 SSRF
- 용도: 외부에서 못 들어가는 내부망 자원을 “서버가 대신 요청”하게 함
- 게임화: 웹앱의 `server.fetch` 기능을 이용해 내부 관리 API 접근
- 역할: 내부망 확장, 메타데이터/관리 포트 접근

필요: `web/http`, `net`, `monitor`

### 4.2 파일 업로드 검증 실패
- 용도: 업로드가 ‘컨텐츠’가 아니라 ‘설정/플러그인’으로 취급될 때 위험
- 게임화: “플러그인 업로드/테마 업로드”로 추상화
- 역할: 공급망/권한/설정 변경으로 연결

필요: `web/http`, `pkg`, `fs`, `monitor`

### 4.3 보안 설정 오류(열린 포트/디버그/기본 계정)
- 용도: 거의 모든 쉬운 공격의 시발점
- 게임화: 스캔 결과에 ‘불필요 서비스’가 보이도록 배치
- 역할: 단서 제공 + 빠른 침투 루트

필요: `net`, `auth`, `monitor`

### 4.4 라우터/방화벽 관리면 노출
- 용도: 내부망 진입/ACL 변경/포트포워딩 등 네트워크 퍼즐 핵심
- 게임화: 장비 장악 → 경로 열기 → 내부 자산 공격

필요: `router`, `fw`, `net`, `monitor`

---

## 5) 방어 툴: 로깅/모니터링 시스템

### 목표
- “자동화할수록 빨라지지만 더 시끄러워지는” 트레이드오프 제공
- 유저가 은밀 플레이/속도런 플레이를 선택하도록 만든다

### 구현 아이디어
- 모든 공격 액션은 `trace.noise`를 발생
- 특정 패턴이 모이면 경보:
  - 짧은 시간 다수 로그인 실패 → BRUTE_FORCE
  - 폭넓은 포트 스캔 → PORT_SCAN
  - 대량 요청 → DOS
- 경보가 뜨면:
  - 방화벽 자동 차단/레이트리밋 강화
  - 관리자가 패치/키 교체/세션 만료 등 대응

필요: `monitor`, (백엔드) `audit` 시스템

---

## 6) (선택) 극후반 근미래 요소: “양자 장비”
- 콘셉트: “옛날에 캡처된 암호화 트래픽/아카이브”는 후반 장비로 해독 가능
- 최신 시스템은 포스트-양자(PQC)로 넘어가 있어 양자 장비로도 안 뚫림
- 목적: 양자 = 만능 치트가 아니라 “암호 전환/자산 관리” 교훈을 주기

---

## 참고 링크(원문)
```text
OWASP Top 10:2021: https://owasp.org/Top10/2021/
OWASP Top 10 for LLM Apps: https://owasp.org/www-project-top-10-for-large-language-model-applications/
MITRE ATT&CK T1566 Phishing: https://attack.mitre.org/techniques/T1566/
```
