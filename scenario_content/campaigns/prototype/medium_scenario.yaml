---
ServerSpec:
  mediumMainServer:
    initialStatus: online
    initialReason: OK
    hostname: medium_server
    users:
      mediumMainUser1:
        userId: root
        passwd: null
        authMode: OTP
        privilege:
          read: true
          write: true
          execute: true
    daemons:
      OTP:
        userKey: mediumMainUser1
        stepMs: 1000
        allowedDriftSteps: 1
        otpPairId: X2BW6QOI53QNUHBXCBYN6XADEQFPR5FJ
  mediumGatewayServer:
    initialStatus: online
    initialReason: OK
    hostname: medium_gateway
    users:
      mediumMainUser1:
        userId: root
        passwd: c5_numspecial
        authMode: static
        privilege:
          read: true
          write: true
          execute: true
    diskOverlay:
      overlayEntries:
        /doc/security_report.txt:
          entryKind: File
          contentId: res://scenario_content/resources/text/scenario_docs/medium_hint.txt 
          fileKind: Text
    daemons:
      OTP:
        userKey: mediumMainUser1
        stepMs: 1000
        allowedDriftSteps: 1
        otpPairId: X2BW6QOI53QNUHBXCBYN6XADEQFPR5FJ
  mediumOTPIssuerServer:
    initialStatus: online
    initialReason: OK
    hostname: medium_otp
    users:
      mediumOTPUser1:
        userId: root
        passwd: null
        authMode: none
        privilege:
          read: true
          write: true
          execute: true
    diskOverlay:
      overlayEntries:
        /opt/bin/optgen:
          entryKind: File
          contentId: res://scenario_content/resources/bin/mediumOTPIssuerServerOtpgen.bin
          fileKind: ExecutableScript
Scenario:
  mediumScenario:
    servers:
      mediumScenario/mediumMainServer:
        specId: mediumMainServer
        role: terminal
        interfaces:
          - netId: mediumSubnet
            initiallyExposed: true
      mediumScenario/mediumGatewayServer:
        specId: mediumGatewayServer
        role: terminal
        interfaces:
          - netId: internet
            initiallyExposed: true
          - netId: mediumSubnet
            initiallyExposed: true
      mediumScenario/mediumOTPIssuerServer:
        specId: mediumOTPIssuerServer
        role: otpGenerator
        interfaces:
          - netId: mediumSubnet
            initiallyExposed: true
    subnetTopology:
      mediumSubnet:
        addressPlan: 10.0.0.0/24
        links:
        - a: mediumScenario/mediumGatewayServer
          b: mediumScenario/mediumOTPIssuerServer
        - a: mediumScenario/mediumGatewayServer
          b: mediumScenario/mediumMainServer
    events:
      mediumScenarioWinEvent:
        conditionType: privilegeAcquire
        conditionArgs:
          nodeId: mediumScenario/mediumMainServer
          userKey: mediumMainUser1
          privilege: execute
        actions:
          - actionType: print
            actionArgs:
              text: You passed [Medium] scenario!
