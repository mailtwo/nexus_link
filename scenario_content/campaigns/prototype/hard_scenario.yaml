---
ServerSpec:
  hardGatewayServer:
    initialStatus: online
    initialReason: OK
    hostname: hard_gateway
    users:
      hardGatewayUser1:
        userId: root
        passwd: AUTO:c3_numspecial
        authMode: static
        privilege:
          read: true
          write: true
          execute: true
  hardTerminal1Server:
    initialStatus: online
    initialReason: OK
    hostname: hard_terminal1
    users:
      hardTerminal1User1:
        userId: root
        passwd: AUTO:c3_numspecial
        authMode: static
        privilege:
          read: true
          write: true
          execute: true
    diskOverlay:
      overlayEntries:
        /doc/email.txt:
          entryKind: File
          contentId: res://scenario_content/resources/text/scenario_docs/hard_hint1.txt 
          fileKind: Text
  hardTerminal2Server:
    initialStatus: online
    initialReason: OK
    hostname: hard_terminal2
    users:
      hardTerminal2User1:
        userId: root
        passwd: AUTO:c4_numspecial
        authMode: static
        privilege:
          read: true
          write: true
          execute: true
  hardTerminal3Server:
    initialStatus: online
    initialReason: OK
    hostname: hard_terminal3
    users:
      hardTerminal3User1:
        userId: root
        passwd: AUTO:c3_numspecial
        authMode: static
        privilege:
          read: true
          write: true
          execute: true
  hardTerminal4Server:
    initialStatus: online
    initialReason: OK
    hostname: hard_terminal4
    users:
      hardTerminal4User1:
        userId: root
        passwd: AUTO:c5_numspecial
        authMode: static
        privilege:
          read: true
          write: true
          execute: true
    diskOverlay:
      overlayEntries:
        /doc/email.txt:
          entryKind: File
          contentId: res://scenario_content/resources/text/scenario_docs/hard_hint2.txt 
          fileKind: Text
  hardTerminal5Server:
    initialStatus: online
    initialReason: OK
    hostname: hard_terminal5
    users:
      hardTerminal5User1:
        userId: root
        passwd: AUTO:c4_numspecial
        authMode: static
        privilege:
          read: true
          write: true
          execute: true
    diskOverlay:
      overlayEntries:
        /doc/email.txt:
          entryKind: File
          contentId: res://scenario_content/resources/text/scenario_docs/hard_hint3.txt 
          fileKind: Text
  hardGuard1Server:
    initialStatus: online
    initialReason: OK
    hostname: hard_guard1
    users:
      hardGuard1User1:
        userId: root
        passwd: AUTO:c3_numspecial
        authMode: static
        privilege:
          read: true
          write: true
          execute: true
    diskOverlay:
      overlayEntries:
        /doc/email.txt:
          entryKind: File
          contentId: res://scenario_content/resources/text/scenario_docs/hard_hint4.txt 
          fileKind: Text
        /aegis_shield_security_test.ms:
          entryKind: File
          contentId: res://scenario_content/resources/text/scenario_docs/aegis_shield_security_test.ms
          fileKind: Text
        /break_hard2.ms:
          entryKind: File
          contentId: res://prototype_answer/break_hard2.ms
          fileKind: Text
        /connection_test.ms:
          entryKind: File
          contentId: res://scenario_content/resources/text/scenario_docs/connection_test.ms
          fileKind: Text
        /opt/bin/ms:
          entryKind: File
          contentId: exec:miniscript
          fileKind: ExecutableHardcode
          size: 32000
        /opt/bin/password_breaker:
          entryKind: File
          contentId: res://scenario_content/resources/text/executions/password_breaker.ms
          fileKind: ExecutableScript
  hardGuard2Server:
    initialStatus: online
    initialReason: OK
    hostname: hard_guard2
    users:
      hardGuard2User1:
        userId: root
        passwd: "black_security_pw2"
        authMode: static
        privilege:
          read: true
          write: true
          execute: true
    diskOverlay:
      overlayEntries:
        /connection_test.ms:
          entryKind: File
          contentId: res://scenario_content/resources/text/scenario_docs/connection_test.ms
          fileKind: Text
        /opt/bin/ms:
          entryKind: File
          contentId: exec:miniscript
          fileKind: ExecutableHardcode
          size: 32000
  hardGuard3Server:
    initialStatus: online
    initialReason: OK
    hostname: hard_guard3
    users:
      hardGuard3User1:
        userId: root
        passwd: "black_security_pw3"
        authMode: static
        privilege:
          read: true
          write: true
          execute: true
    diskOverlay:
      overlayEntries:
        /connection_test.ms:
          entryKind: File
          contentId: res://scenario_content/resources/text/scenario_docs/connection_test.ms
          fileKind: Text
        /opt/bin/ms:
          entryKind: File
          contentId: exec:miniscript
          fileKind: ExecutableHardcode
          size: 32000
  hardGuard4Server:
    initialStatus: online
    initialReason: OK
    hostname: hard_guard4
    users:
      hardGuard4User1:
        userId: root
        passwd: AUTO:c4_numspecial
        authMode: static
        privilege:
          read: true
          write: true
          execute: true
    diskOverlay:
      overlayEntries:
        /opt/bin/ms:
          entryKind: File
          contentId: exec:miniscript
          fileKind: ExecutableHardcode
          size: 32000
  hardMainframeServer:
    initialStatus: online
    initialReason: OK
    hostname: hard_mainframe
    users:
      hardMainframeSUser1:
        userId: root
        passwd: AUTO:c4_numspecial
        authMode: static
        privilege:
          read: true
          write: true
          execute: true
    daemons:
      connectionRateLimiter:
        monitorMs: 1000
        threshold: 5
        blockMs: 10000
        rateLimit: 18
        recoveryMs: 30000
Scenario:
  hardScenario:
    servers:
      hardScenario/hardGatewayServer:
        specId: hardGatewayServer
        role: gateway
        interfaces:
          - netId: internet
            initiallyExposed: true
          - netId: hardSubnet
            initiallyExposed: true
      hardScenario/hardTerminal1Server:
        specId: hardTerminal1Server
        role: terminal
        interfaces:
          - netId: hardSubnet
            initiallyExposed: false
      hardScenario/hardTerminal2Server:
        specId: hardTerminal2Server
        role: terminal
        interfaces:
          - netId: hardSubnet
            initiallyExposed: false
      hardScenario/hardTerminal3Server:
        specId: hardTerminal3Server
        role: terminal
        interfaces:
          - netId: hardSubnet
            initiallyExposed: false
      hardScenario/hardTerminal4Server:
        specId: hardTerminal4Server
        role: terminal
        interfaces:
          - netId: hardSubnet
            initiallyExposed: false
      hardScenario/hardGuard1Server:
        specId: hardGuard1Server
        role: terminal
        interfaces:
          - netId: hardSubnet
            initiallyExposed: false
      hardScenario/hardGuard2Server:
        specId: hardGuard2Server
        role: terminal
        interfaces:
          - netId: hardSubnet
            initiallyExposed: false
      hardScenario/hardGuard3Server:
        specId: hardGuard3Server
        role: terminal
        interfaces:
          - netId: hardSubnet
            initiallyExposed: false
      hardScenario/hardGuard4Server:
        specId: hardGuard4Server
        role: terminal
        interfaces:
          - netId: hardSubnet
            initiallyExposed: false
      hardScenario/hardMainframeServer:
        specId: hardMainframeServer
        role: mainframe
        interfaces:
          - netId: hardSubnet
            initiallyExposed: false
    subnetTopology:
      hardSubnet:
        addressPlan: 11.0.0.0/24
        links:
        - a: hardScenario/hardGatewayServer
          b: hardScenario/hardTerminal1Server
        - a: hardScenario/hardGatewayServer
          b: hardScenario/hardTerminal2Server
        - a: hardScenario/hardTerminal1Server
          b: hardScenario/hardTerminal3Server
        - a: hardScenario/hardTerminal2Server
          b: hardScenario/hardTerminal4Server
        - a: hardScenario/hardTerminal4Server
          b: hardScenario/hardGuard1Server
        - a: hardScenario/hardTerminal4Server
          b: hardScenario/hardGuard2Server
        - a: hardScenario/hardGuard1Server
          b: hardScenario/hardGuard2Server
        - a: hardScenario/hardGuard1Server
          b: hardScenario/hardGuard3Server
        - a: hardScenario/hardGuard1Server
          b: hardScenario/hardGuard4Server
        - a: hardScenario/hardGuard1Server
          b: hardScenario/hardMainframeServer
        - a: hardScenario/hardGuard2Server
          b: hardScenario/hardMainframeServer
        - a: hardScenario/hardGuard3Server
          b: hardScenario/hardMainframeServer
        - a: hardScenario/hardGuard4Server
          b: hardScenario/hardMainframeServer
    events:
      hardScenarioWinEvent:
        conditionType: privilegeAcquire
        conditionArgs:
          nodeId: hardScenario/hardMainframeServer
          userKey: hardMainframeSUser1
          privilege: execute
        actions:
          - actionType: print
            actionArgs:
              text: You passed [Hard] scenario!
